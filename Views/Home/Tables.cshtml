@using Champions.Models;
@model  Tuple<List<Groups>, List<Players>>

@{
    ViewBag.Title = "Tables";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container-fluid mt-5 text-center">
    <br />
    <br />
    <h3 class="mb-3 font-weight-normal" style="color:white">נתונים</h3>
    <div class="row">
        <div class="col-md-12 col-lg-4 col-sm-12">
            <h3 class="font-weight-normal mt-2" style="color:white">בית א</h3>
            @if ((string)Session["AdimCode"] == "Admin")
            {
                <button id="בית א" class="btn btn-sm mb-2" type="reset" style="background: #CACFD2; border-color: transparent; color: black" onClick="reply_click(this.id)"> ערוך</button>
            }
            <div class="card" style=" height: 400px; overflow-y: auto;">
                <div class="card-body">
                    <div class="table-responsive">
                        <table id="myTable" class="table table-striped table-bordered text-center">
                            <tr>
                                <th>קבוצה</th>
                                <th>נקודות</th>
                            </tr>
                            @foreach (var item in Model.Item1)
                            {
                                if (item.Name.Trim() == "A")
                                {
                                    foreach (var item2 in item.TeamsList)
                                    {
                                        <tr>
                                            <td>
                                                <div class="row d-inline-block float-right m-2 m-sm-1">
                                                    <img src="@item2.Img" alt="" class="rounded shadow-lg" style="width:2em">
                                                    @Html.DisplayFor(modelItem => item2.Name)
                                                </div>
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item2.Points)
                                            </td>
                                        </tr>
                                    }
                                }
                            }
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-12 col-lg-4 col-sm-12">
            <h3 class="font-weight-normal  mt-2" style="color:white">בית ב</h3>
            @if ((string)Session["AdimCode"] == "Admin")
            {
                <button id="בית ב" class="btn btn-sm mb-2" type="reset" style="background: #CACFD2; border-color: transparent; color: black" onClick="reply_click(this.id)"> ערוך</button>
            }
            <div class="card" style=" height: 400px; overflow-y: auto;">
                <div class="card-body">
                    <div class="table-responsive">
                        <table id="myTable" class="table table-striped table-bordered text-center">
                            <tr>
                                <th>קבוצה</th>
                                <th>נקודות</th>
                            </tr>
                            @foreach (var item in Model.Item1)
                            {
                                if (item.Name.Trim() == "B")
                                {
                                    foreach (var item2 in item.TeamsList)
                                    {
                                        <tr>
                                            <td>
                                                <div class="row d-inline-block float-right m-2 m-sm-1">
                                                    <img src="@item2.Img" alt="" class="rounded shadow-lg" style="width:2em">
                                                    @Html.DisplayFor(modelItem => item2.Name)
                                                </div>
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item2.Points)
                                            </td>
                                        </tr>
                                    }
                                }
                            }
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-12 col-lg-4 col-sm-12">
            <h3 class="font-weight-normal  mt-2" style="color:white">בית ג</h3>
            @if ((string)Session["AdimCode"] == "Admin")
            {
                <button id="בית ג" class="btn btn-sm mb-2" type="reset" style="background: #CACFD2; border-color: transparent; color: black" onClick="reply_click(this.id)"> ערוך</button>
            }
            <div class="card" style=" height: 400px; overflow-y: auto;">
                <div class="card-body">
                    <div class="table-responsive">
                        <table id="myTable" class="table table-striped table-bordered text-center">
                            <tr>
                                <th>קבוצה</th>
                                <th>נקודות</th>
                            </tr>
                            @foreach (var item in Model.Item1)
                            {
                                if (item.Name.Trim() == "C")
                                {
                                    foreach (var item2 in item.TeamsList)
                                    {
                                        <tr>
                                            <td>
                                                <div class="row d-inline-block float-right m-2 m-sm-1">
                                                    <img src="@item2.Img" alt="" class="rounded shadow-lg" style="width:2em">
                                                    @Html.DisplayFor(modelItem => item2.Name)
                                                </div>
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item2.Points)
                                            </td>
                                        </tr>
                                    }
                                }
                            }
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 col-lg-4 col-sm-12">
            <h3 class="font-weight-normal mt-2" style="color:white">בית ד</h3>
            @if ((string)Session["AdimCode"] == "Admin")
            {
                <button id="בית ד" class="btn btn-sm mb-2" type="reset" style="background: #CACFD2; border-color: transparent; color: black" onClick="reply_click(this.id)"> ערוך</button>
            }
            <div class="card" style=" height: 400px; overflow-y: auto;">
                <div class="card-body">
                    <div class="table-responsive">
                        <table id="myTable" class="table table-striped table-bordered text-center">
                            <tr>
                                <th>קבוצה</th>
                                <th>נקודות</th>
                            </tr>
                            @foreach (var item in Model.Item1)
                            {
                                if (item.Name.Trim() == "D")
                                {
                                    foreach (var item2 in item.TeamsList)
                                    {
                                        <tr>
                                            <td>
                                                <div class="row d-inline-block float-right m-2 m-sm-1">
                                                    <img src="@item2.Img" alt="" class="rounded shadow-lg" style="width:2em">
                                                    @Html.DisplayFor(modelItem => item2.Name)
                                                </div>
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item2.Points)
                                            </td>
                                        </tr>
                                    }
                                }
                            }
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-12 col-lg-4 col-sm-12">
            <h3 class="font-weight-normal  mt-2" style="color:white">בית ה</h3>
            @if ((string)Session["AdimCode"] == "Admin")
            {
                <button id="בית ה" class="btn btn-sm mb-2" type="reset" style="background: #CACFD2; border-color: transparent; color: black" onClick="reply_click(this.id)"> ערוך</button>
            }
            <div class="card" style=" height: 400px; overflow-y: auto;">
                <div class="card-body">
                    <div class="table-responsive">
                        <table id="myTable" class="table table-striped table-bordered text-center">
                            <tr>
                                <th>קבוצה</th>
                                <th>נקודות</th>
                            </tr>
                            @foreach (var item in Model.Item1)
                            {
                                if (item.Name.Trim() == "E")
                                {
                                    foreach (var item2 in item.TeamsList)
                                    {
                                        <tr>
                                            <td>
                                                <div class="row d-inline-block float-right m-2 m-sm-1">
                                                    <img src="@item2.Img" alt="" class="rounded shadow-lg" style="width:2em">
                                                    @Html.DisplayFor(modelItem => item2.Name)
                                                </div>
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item2.Points)
                                            </td>
                                        </tr>
                                    }
                                }
                            }
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-12 col-lg-4 col-sm-12">
            <h3 class="font-weight-normal  mt-2" style="color:white">בית ו</h3>
            @if ((string)Session["AdimCode"] == "Admin")
            {
                <button id="בית ו" class="btn btn-sm mb-2" type="reset" style="background: #CACFD2; border-color: transparent; color: black" onClick="reply_click(this.id)"> ערוך</button>
            }
            <div class="card" style=" height: 400px; overflow-y: auto;">
                <div class="card-body">
                    <div class="table-responsive">
                        <table id="myTable" class="table table-striped table-bordered text-center">
                            <tr>
                                <th>קבוצה</th>
                                <th>נקודות</th>
                            </tr>
                            @foreach (var item in Model.Item1)
                            {
                                if (item.Name.Trim() == "F")
                                {
                                    foreach (var item2 in item.TeamsList)
                                    {
                                        <tr>
                                            <td>
                                                <div class="row d-inline-block float-right m-2 m-sm-1">
                                                    <img src="@item2.Img" alt="" class="rounded shadow-lg" style="width:2em">
                                                    @Html.DisplayFor(modelItem => item2.Name)
                                                </div>
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item2.Points)
                                            </td>
                                        </tr>
                                    }
                                }
                            }
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 col-lg-4 col-sm-12">
            <h3 class="font-weight-normal mt-2" style="color:white">בית ז</h3>
            @if ((string)Session["AdimCode"] == "Admin")
            {
                <button id="בית ז" class="btn btn-sm mb-2" type="reset" style="background: #CACFD2; border-color: transparent; color: black" onClick="reply_click(this.id)"> ערוך</button>
            }
            <div class="card" style=" height: 400px; overflow-y: auto;">
                <div class="card-body">
                    <div class="table-responsive">
                        <table id="myTable" class="table table-striped table-bordered text-center">
                            <tr>
                                <th>קבוצה</th>
                                <th>נקודות</th>
                            </tr>
                            @foreach (var item in Model.Item1)
                            {
                                if (item.Name.Trim() == "G")
                                {
                                    foreach (var item2 in item.TeamsList)
                                    {
                                        <tr>
                                            <td>
                                                <div class="row d-inline-block float-right m-2 m-sm-1">
                                                    <img src="@item2.Img" alt="" class="rounded shadow-lg" style="width:2em">
                                                    @Html.DisplayFor(modelItem => item2.Name)
                                                </div>
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item2.Points)
                                            </td>
                                        </tr>
                                    }
                                }
                            }
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-12 col-lg-4 col-sm-12">
            <h3 class="font-weight-normal  mt-2" style="color:white">בית ח</h3>
            @if ((string)Session["AdimCode"] == "Admin")
            {
                <button id="בית ח" class="btn btn-sm mb-2" type="reset" style="background: #CACFD2; border-color: transparent; color: black" onClick="reply_click(this.id)"> ערוך</button>
            }
            <div class="card" style=" height: 400px; overflow-y: auto;">
                <div class="card-body">
                    <div class="table-responsive">
                        <table id="myTable" class="table table-striped table-bordered text-center">
                            <tr>
                                <th>קבוצה</th>
                                <th>נקודות</th>
                            </tr>
                            @foreach (var item in Model.Item1)
                            {
                                if (item.Name.Trim() == "H")
                                {
                                    foreach (var item2 in item.TeamsList)
                                    {
                                        <tr>
                                            <td>
                                                <div class="row d-inline-block float-right m-2 m-sm-1">
                                                    <img src="@item2.Img" alt="" class="rounded shadow-lg" style="width:2em">
                                                    @Html.DisplayFor(modelItem => item2.Name)
                                                </div>
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item2.Points)
                                            </td>
                                        </tr>
                                    }
                                }
                            }
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-12 col-lg-4 col-sm-12">
            <h3 class="font-weight-normal  mt-2" style="color:white">מלך השערים</h3>
            @if ((string)Session["AdimCode"] == "Admin")
            {
                <button id="goals" class="btn btn-sm mb-2" type="reset" style="background: #CACFD2; border-color: transparent; color: black" onClick="reply_click(this.id)"> ערוך</button>
            }
            <div class="card" style=" height: 400px; overflow-y: auto;">
                <div class="card-body">
                    <div class="table-responsive">
                        <table id="myTable" class="table table-striped table-bordered text-center">
                            <tr>
                                <th>שם</th>
                                <th>גולים</th>
                            </tr>
                            @foreach (var item in Model.Item2)
                            {
                                if (item.Goals == 0)
                                {
                                    continue;
                                }
                                <tr>
                                    <td>
                                        <div class="row d-inline-block float-right m-2 m-sm-1">
                                            <img src="@item.Img" alt="" class="rounded shadow-lg" style="width:2em">
                                            @Html.DisplayFor(modelItem => item.Name)
                                        </div>
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Goals)
                                    </td>
                                </tr>
                            }
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="myModalSave" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title float-right"><span id="eventTitle"></span></h4>
                <button type="button" class="close float-left ml-0" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
                <form class="form-horizontal">
                    <div class="form-row">
                        <div class="col">
                            <label class="float-right mt-2"><span id="Team1Name"></span></label>
                        </div>
                        <div class="col">
                            <input type="text" id="Team1Points" class="form-control w-50 text-center" />
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col">
                            <label class="float-right mt-2"><span id="Team2Name"></span></label>
                        </div>
                        <div class="col">
                            <input type="text" id="Team2Points" class="form-control w-50 text-center" />
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col">
                            <label class="float-right mt-2"><span id="Team3Name"></span></label>
                        </div>
                        <div class="col">
                            <input type="text" id="Team3Points" class="form-control w-50 text-center" />
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col">
                            <label class="float-right mt-2"><span id="Team4Name"></span></label>
                        </div>
                        <div class="col">
                            <input type="text" id="Team4Points" class="form-control w-50 text-center" />
                        </div>
                    </div>

                    <button type="button" id="btnSave" class="btn btn-secondary alig" style="background: #CACFD2; border-color: transparent; color: black">שמור</button>
                </form>
            </div>
        </div>
    </div>
</div>
<br/>
<br/>

@section Scripts{
    <script>
        function reply_click(clicked_id) {
            $('#myModalSave #eventTitle').text(clicked_id);
            var myArray = [];
            if (clicked_id == "בית א") {
                @foreach (var d in Model.Item1.FirstOrDefault(x=>x.Name== "A").TeamsList)
                {
                    @:myArray.push({ "Name": "@d.Name", "Points": "@d.Points" });
                }
            }
             if (clicked_id == "בית ב") {
                @foreach (var d in Model.Item1.FirstOrDefault(x=>x.Name== "B").TeamsList)
                {
                    @:myArray.push({ "Name": "@d.Name", "Points": "@d.Points" });
                }
            }
             if (clicked_id == "בית ג") {
                @foreach (var d in Model.Item1.FirstOrDefault(x=>x.Name== "C").TeamsList)
                {
                    @:myArray.push({ "Name": "@d.Name", "Points": "@d.Points" });
                }
            }
             if (clicked_id == "בית ד") {
                @foreach (var d in Model.Item1.FirstOrDefault(x=>x.Name== "D").TeamsList)
                {
                    @:myArray.push({ "Name": "@d.Name", "Points": "@d.Points" });
                }
            }
         if (clicked_id == "בית ה") {
                @foreach (var d in Model.Item1.FirstOrDefault(x=>x.Name== "E").TeamsList)
                {
                    @:myArray.push({ "Name": "@d.Name", "Points": "@d.Points" });
                }
            }
         if (clicked_id == "בית ו") {
                @foreach (var d in Model.Item1.FirstOrDefault(x=>x.Name== "F").TeamsList)
                {
                    @:myArray.push({ "Name": "@d.Name", "Points": "@d.Points" });
                }
            }
         if (clicked_id == "בית ז") {
                @foreach (var d in Model.Item1.FirstOrDefault(x=>x.Name== "G").TeamsList)
                {
                    @:myArray.push({ "Name": "@d.Name", "Points": "@d.Points" });
                }
            }
         if (clicked_id == "בית ח") {
                @foreach (var d in Model.Item1.FirstOrDefault(x=>x.Name== "H").TeamsList)
                {
                    @:myArray.push({ "Name": "@d.Name", "Points": "@d.Points" });
                }
            }
            if (clicked_id == "goals") {
                @foreach (var d in Model.Item2)
                {
                    @:myArray.push({ "Name": "@d.Name", "Goals": "@d.Goals" });
                }
            }

            $('#myModalSave #Team1Name').text(myArray[0].Name);
            $('#myModalSave #Team1Points').val(myArray[0].Points);
            $('#myModalSave #Team2Name').text(myArray[1].Name);
            $('#myModalSave #Team2Points').val(myArray[1].Points);
            $('#myModalSave #Team3Name').text(myArray[2].Name);
            $('#myModalSave #Team3Points').val(myArray[2].Points);
            $('#myModalSave #Team4Name').text(myArray[3].Name);
            $('#myModalSave #Team4Points').val(myArray[3].Points);

            $('#myModalSave').modal();
        }

        $('#btnSave').click(function () {
            var data = [];
            data.push({ Name: $('#Team1Name').text().trim(), Points: $('#Team1Points').val().trim(), });
            data.push({ Name: $('#Team2Name').text().trim(), Points: $('#Team2Points').val().trim(), });
            data.push({ Name: $('#Team3Name').text().trim(), Points: $('#Team3Points').val().trim(), })
            data.push({ Name: $('#Team4Name').text().trim(), Points: $('#Team4Points').val().trim(), })

            SaveEvent(data);// call function for submit data to the server
        })

        function SaveEvent(data) {
            $.ajax({
                type: "POST",
                url: '/Home/UpdateTables',
                contentType: "application/json",
                async: true,
                data: JSON.stringify(data),
                success: function (data) {
                     $('#myModalSave').modal('hide');
                    location.reload();
                },
                error: function (result) {
                    alert('Failed ' + result.message);
                }
            })
        }

    </script>
}




